<!DOCTYPE html>
<html>
  <head>
    <title>Excel Processor</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <h2>Upload Excel File</h2>

    <input type="file" id="fileInput" accept=".xlsx" />
    <br /><br />
    <button onclick="upload()">Upload & Download</button>

    <script>
      function upload() {
        const fileInput = document.getElementById("fileInput");

        if (!fileInput.files.length) {
          alert("Please select a file");
          return;
        }

        const formData = new FormData();
        formData.append("file", fileInput.files[0]);

        fetch("https://excel-backend.onrender.com/process", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.blob())
          .then((blob) => {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "GLOWLINK_Repeated_Names.xlsx";
            a.click();
          })
          .catch(() => alert("Processing failed"));
      }
    </script>
  </body>
</html>
